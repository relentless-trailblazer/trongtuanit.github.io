<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Satisfy&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

</head>
<body>
  <div id="app">
    <div id="time"></div>
    <div id="date"></div>
  </div>
  <!-- <div id="wrapper">
    <div id="container">
      <div id="container-play">
        <a id="play" href="javascript:void(0)">Click to play</a>
      </div>
      <div id="alert_puzzle"></div>
      <div id="puzzle">
        <div number="1" class="cell-puzzle row-1 col-1">1</div>
        <div number="2" class="cell-puzzle row-1 col-2">2</div>
        <div number="3" class="cell-puzzle row-1 col-3">3</div>
        <div number="4" class="cell-puzzle row-1 col-4">4</div>
        <div number="5" class="cell-puzzle row-2 col-1">5</div>
        <div number="6" class="cell-puzzle row-2 col-2">6</div>
        <div number="7" class="cell-puzzle row-2 col-3">7</div>
        <div number="8" class="cell-puzzle row-2 col-4">8</div>
        <div number="9" class="cell-puzzle row-3 col-1">9</div>
        <div number="10" class="cell-puzzle row-3 col-2">10</div>
        <div number="11" class="cell-puzzle row-3 col-3">11</div>
        <div number="12" class="cell-puzzle row-3 col-4">12</div>
        <div number="13" class="cell-puzzle row-4 col-1">13</div>
        <div number="14" class="cell-puzzle row-4 col-2">14</div>
        <div number="15" class="cell-puzzle row-4 col-3">15</div>
        <div number="0" class="cell-puzzle row-4 col-4 cell-puzzle-zero"></div>
      </div>
      <div id="board-time">00:00</div>
    </div>
  </div> -->
  <script src="./script.js"></script>
  <!-- <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script> -->
  <!-- <script>
  // ma trận toàn cục điều khiển mọi hoạt động của game
  var matrix = [
    [1, 2, 3, 4],
    [5, 6, 7, 8],
    [9, 10, 11, 12],
    [13, 14, 15, 0],
  ];

  // các biến toàn cục dùng để tính giờ
  var secs = 0;
  var currentSeconds = 0;
  var currentMinutes = 0;
  var timer;

  // gọi sự kiện bắt đầu game khi ấn nút play
  $("#play").bind("click",function(){
    initialize();
    beginTime();
    $("#alert_puzzle").text("");
  })

  // Khi click vào 1 sô thì gọi đến hàm move để di chuyển
  $("#puzzle .cell-puzzle").bind("click",function() {
    if(secs > 0){
      var obj = $(this);
      move(obj);
    }
  })

  // hàm init game, gọi 1 dãy số từ 1 đến 15 bất kì, sắp xếp các element theo dãy số đó để bắt đầu game
  function initialize(){
    var arrRandomNumber = shuffleMatrix();

    var count = 0;
    for(var i = 0; i < 4; i++) {
      for(var j = 0; j < 4; j++) {
        var number = arrRandomNumber[count];
        matrix[i][j] = number;

        if (i == 3 && j == 3) {
          matrix[i][j] = 0;
        }

        $("#puzzle .cell-puzzle[number=" + number + "]").css("top", i * 60 + "px");
        $("#puzzle .cell-puzzle[number=" + number + "]").css("left", j * 60 + "px");
        count++;
      }
    }
  }

  // hàm tạo dãy số bất kì từ 1 đến 15
  function shuffleMatrix(){
    var arr = [];
    while(arr.length < 15){
      var r = Math.floor(Math.random() * 15) + 1;
      if(arr.indexOf(r) === -1) arr.push(r);
    }

    return arr;
  }

  // hàm bắt đầu đếm giờ
  function beginTime() {
    secs = 0;
    currentSeconds = 0;
    currentMinutes = 0;
    clearTimeout(timer);
    intervalTime();
  }

  // hàm đếm giờ
  function intervalTime() {
    currentMinutes = Math.floor(secs / 60);
    currentSeconds = secs % 60;

    if(currentMinutes <= 9) {
      currentMinutes = "0" + currentMinutes;
    }

    if(currentSeconds <= 9) {
      currentSeconds = "0" + currentSeconds;
    }

    secs++;
    $("#board-time").text(currentMinutes + ":" + currentSeconds);
    timer = setTimeout('intervalTime()', 1000);
    console.log(secs);
  }

  // hàm di chuyển các ô.
  function move(obj) {
    var numberCell = parseFloat(obj.attr("number"));
    var win = false;
    for(var i = 0; i < 4; i++) {
      for(var j = 0; j < 4; j++) {
        if(matrix[i][j] == numberCell) {
          if(j > 0 && matrix[i][j-1] == 0) {
            $("#puzzle .cell-puzzle[number=0]").css("left", j * 60 + "px");
            obj.animate({
              'left': (j - 1) * 60 + 'px'
            }, 150);

            matrix[i][j - 1] = numberCell;
            matrix[i][j] = 0;

          } else if(j < 3 && matrix[i][j + 1] == 0) {
            $("#puzzle .cell-puzzle[number=0]").css("left",j * 60 + "px");
            obj.animate({
              'left': (j + 1) * 60 + 'px'
            }, 150);

            matrix[i][j + 1] = numberCell;
            matrix[i][j] = 0;

          } else if(i > 0 && matrix[i - 1][j] == 0) {
            $("#puzzle .cell-puzzle[number=0]").css("top", i * 60 + "px");
            obj.animate({
              'top': (i - 1) * 60 + 'px'
            },150);

            matrix[i-1][j] = numberCell;
            matrix[i][j] = 0;

          } else if(i<3 && matrix[i+1][j]==0) {
            $("#puzzle .cell-puzzle[number=0]").css("top", i * 60 + "px");
            obj.animate({
              'top': (i + 1) * 60 + 'px'
            },150);

            matrix[i + 1][j] = numberCell;
            matrix[i][j]=0;
          }
          win = checkWin();
          if (win){
            break;
          }
          return; 
        }
      }
    }
  }
  // hàm kiểm tra và báo chiến thắng
  function checkWin(){
    var winner =false;
    var winString = "1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0";
    var loseString = "1,2,3,4,5,6,7,8,9,10,11,12,13,15,14,0";

    var matrixStr = matrix.toString();

    if(winString == matrixStr) {
      clearTimeout(timer);
      $("#alert_puzzle").text("You win! High score:" + $("#board-time").text());

    } else if (loseString == matrixStr) {
      $("#alert_puzzle").text('There is no door for you! Click "click to play" to start a new game.');
    }
  }
  </script> -->
</body>
</html>